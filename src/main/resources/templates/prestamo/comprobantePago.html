<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${prestamo.montoMulta > 0 ? 'Comprobante de Pago (Multa)' : 'Ticket de Devolución'}">Comprobante / Ticket</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" 
          rel="stylesheet">
    <style>
        .comprobante-box { border: 1px solid #ccc; padding: 30px; border-radius: 8px; max-width: 600px; margin: 30px auto; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        
        .header-multa { background-color: #dc3545; color: white; padding: 15px; border-radius: 5px 5px 0 0; text-align: center; margin: -30px -30px 20px; }
        
        .header-ticket { background-color: #198754; color: white; padding: 15px; border-radius: 5px 5px 0 0; text-align: center; margin: -30px -30px 20px; }
        
        @media print {
            .no-print { display: none; }
        }
    </style>
</head>
<body>

<div class="comprobante-box">
    
    <div th:classappend="${prestamo.montoMulta > 0 ? 'header-multa' : 'header-ticket'}">
        <h3 class="mb-0" 
            th:text="${prestamo.montoMulta > 0 ? 'COMPROBANTE DE PAGO (MULTA)' : 'TICKET DE DEVOLUCIÓN'}">
            COMPROBANTE DE PAGO (MULTA)
        </h3>
    </div>

    <div class="row mb-3">
        <div class="col-6"><strong>Nº Operación:</strong> <span th:text="${prestamo.id}"></span></div>
        <div class="col-6 text-end"><strong>Fecha de Emisión:</strong> <span th:text="${#temporals.format(T(java.time.LocalDate).now(), 'dd-MM-yyyy')}"></span></div>
    </div>
    
    <hr>

    <h4>Detalles del Socio</h4>
    <p><strong>Nombre:</strong> <span th:text="${prestamo.socio.nombre}"></span></p>
    <p><strong>Identificación:</strong> <span th:text="${prestamo.socio.identificacion}"></span></p>
    <hr>
    
    <h4>Detalles del Préstamo</h4>
    <p><strong>Libro:</strong> <span th:text="${prestamo.libro.titulo}"></span></p>
    <p><strong>ISBN:</strong> <span th:text="${prestamo.libro.isbn}"></span></p>
    <p><strong>Fecha Límite:</strong> <span th:text="${prestamo.fechaDevolucionEsperada}"></span></p>
    <p><strong>Fecha Devolución:</strong> <span th:text="${prestamo.fechaDevolucionReal}"></span></p>
    <hr>
    
    <h5 class="mb-3" 
        th:classappend="${prestamo.montoMulta > 0 ? 'text-danger' : 'text-success'}"
        th:text="${prestamo.montoMulta > 0 ? 'RESUMEN DEL PAGO (MULTA)' : 'ESTADO DE DEVOLUCIÓN'}">
        RESUMEN DEL PAGO
    </h5>
    
    <ul class="list-group mb-4">
        <li class="list-group-item d-flex justify-content-between align-items-center">
            Días de Retraso:
            <span class="badge rounded-pill" 
                  th:classappend="${prestamo.montoMulta > 0 ? 'bg-danger' : 'bg-success'}"
                  th:text="${diasRetraso}">5</span>
        </li>
        <li class="list-group-item d-flex justify-content-between align-items-center fw-bold">
            <span th:text="${prestamo.montoMulta > 0 ? 'TOTAL PAGADO:' : 'MULTA GENERADA:'}">TOTAL PAGADO:</span>
            
            <span class="fs-4 text-success" 
                  th:text="'S/' + ${#numbers.formatDecimal(prestamo.montoMulta, 0, 2)}">
                  S/5.00
            </span>
        </li>
    </ul>
    
    <p class="text-center text-muted">** Documento generado por el Sistema de Biblioteca **</p>

    <div class="text-center mt-4 no-print">
        <button onclick="window.print()" class="btn btn-primary me-2">
            <i class="bi bi-printer"></i> Imprimir / Guardar PDF
        </button>
        <a th:href="@{/prestamos}" class="btn btn-secondary">Volver a Préstamos</a>
    </div>

</div>

</body>
</html>